{% extends "page_template.html" %}


{% block browserTitle %} {{ block.super }} - Filters{% endblock %}

{% block pageTitle %} Filters {% endblock  %}

{% block menuFiltersClass %}pl-highlight{% endblock %}


{% block extraFiles %}
    
    <style>

      .filter-details {
        display: none;
        padding-bottom: 5px;
        padding-left: 18px;
      }
      
      .filter-details-text {
        background-color: rgb(180, 211, 173);
        border-radius: 6px;
        display: inline-block;
        margin-right: 20px;
        padding: 2px 4px 3px 4px;
      }
      
    </style>
    
    <script>
        
        (($) => {
        
            $(() => {
                
                $('.pl-toggle-details').click((e) => {
                    e.preventDefault();
                    $(`#${e.currentTarget.id.split('-toggle')[0]}`).toggle();
                });
                
            });
        
        })(jQuery);
        
    </script>
    
{% endblock %}

{% block content %}
    <div class="{{ templateHelpers.classes.grid }} mt4">
        <div>
            <p class="mb4">Filters are used to scope the reports list page and dashboard view. They allow you to easily view a particular subset of URLs.</p>
            
            {% if filter_sets.count == 0 %}
                <p>There are currently no filter sets. Contact an admin to have one created for you.</p>
            
            {% else %}
                {% for filter, parts in filter_sets %}
                    <div class="mb1-ns mb4">
                        <div class="flex-ns items-center">
                            <div class="w5 mr4 mb1">{{ filter.name }}</div>
                            <div class="w3 f4 mb1 light-silver">[<a href="#" aria-label="Toggle filter details" class="hint--top underline-hover pl-toggle-details" id="{{ filter.slug }}-toggle">+</a>]</div>
                            <div class="w5 db w5-ns w-100 mb1">
                                <a href="{% url 'plr:reports_browse' filter_slug=filter.slug %}" class="{{ templateHelpers.classes.hasIcon }}">Reports {{ templateHelpers.html.icons.chevronForward|safe }}</a>
                                <a href="{% url 'plr:reports_dashboard' filter_slug=filter.slug %}" class="{{ templateHelpers.classes.hasIcon }}">Dashboard {{ templateHelpers.html.icons.chevronForward|safe }}</a>
                                
                            </div>
                            
                        </div>
                        <div id="{{ filter.slug }}" class="filter-details">
                            {% for part in parts %}
                                <p class="filter-details-text">{{ part.prop|title }}: {{ part.filter_val }}</p>
                            {% endfor %}
                        </div>
                    </div>
                {% endfor %}
                
            {% endif %}
            
        </div>
    </div>
{% endblock %}
